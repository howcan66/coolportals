<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>R1-R2A-R3-R2B Integration Test Frame</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #1a1a1a;
            color: #fff;
            padding: 10px;
            display: flex;
            flex-direction: column;
            height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        .frame-header {
            background-color: #0d47a1;
            padding: 4px 8px; /* compact top row */
            border-radius: 3px;
            <!DOCTYPE html>
            <html lang="en">
            <head>
                <meta charset="UTF-8">
                <meta name="viewport" content="width=device-width, initial-scale=1.0">
                <title>Cool Portals</title>
                <style>
                    :root {
                        color-scheme: dark;
                    }

                    * {
                        margin: 0;
                        padding: 0;
                        box-sizing: border-box;
                    }

                    body {
                        font-family: "Segoe UI", Arial, sans-serif;
                        background: radial-gradient(circle at top, #0f2442 0%, #0b0f14 55%, #07090c 100%);
                        color: #f4f6f9;
                        min-height: 100vh;
                        display: flex;
                        flex-direction: column;
                    }

                    header {
                        padding: 32px 24px 16px;
                        text-align: center;
                    }

                    header h1 {
                        font-size: 2rem;
                        font-weight: 700;
                        letter-spacing: 0.5px;
                    }

                    header p {
                        margin-top: 10px;
                        font-size: 1rem;
                        color: #b8c4d0;
                    }

                    main {
                        flex: 1;
                        display: flex;
                        justify-content: center;
                        padding: 24px;
                    }

                    .grid {
                        width: min(1100px, 100%);
                        display: grid;
                        grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
                        gap: 18px;
                    }

                    .card {
                        background: rgba(16, 26, 36, 0.75);
                        border: 1px solid rgba(110, 162, 255, 0.2);
                        border-radius: 12px;
                        padding: 20px;
                        display: flex;
                        flex-direction: column;
                        gap: 12px;
                        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.35);
                    }

                    .card h2 {
                        font-size: 1.15rem;
                    }

                    .card p {
                        color: #b3c1cf;
                        font-size: 0.95rem;
                        line-height: 1.4;
                    }

                    .card a {
                        margin-top: auto;
                        display: inline-flex;
                        align-items: center;
                        gap: 8px;
                        color: #8fd694;
                        text-decoration: none;
                        font-weight: 600;
                    }

                    .card a:hover {
                        color: #b6f0be;
                    }

                    .tag {
                        display: inline-flex;
                        align-items: center;
                        padding: 4px 10px;
                        border-radius: 999px;
                        font-size: 0.75rem;
                        background: rgba(79, 195, 247, 0.15);
                        color: #7ec9ff;
                        border: 1px solid rgba(79, 195, 247, 0.35);
                        width: fit-content;
                    }

                    footer {
                        text-align: center;
                        padding: 18px 24px 26px;
                        font-size: 0.85rem;
                        color: #7c8794;
                    }
                </style>
            </head>
            <body>
                <header>
                    <h1>Cool Portals</h1>
                    <p>Your hub for multiple mini-projects. Pick a portal below.</p>
                </header>

                <main>
                    <section class="grid" aria-label="Project list">
                        <article class="card">
                            <span class="tag">Featured</span>
                            <h2>ðŸŽ¹ Piano Chords & Lyrics</h2>
                            <p>24-row chord workflow with playback, voicing modes, and analysis view.</p>
                            <a href="piano/frame.html">Open Piano App â†’</a>
                        </article>

                        <article class="card">
                            <span class="tag">Planned</span>
                            <h2>ðŸ“… Calendar</h2>
                            <p>Upcoming: a calendar workspace for scheduling and planning.</p>
                            <a href="calendar/">Open Calendar â†’</a>
                        </article>

                        <article class="card">
                            <span class="tag">Coming soon</span>
                            <h2>ðŸ§© Experiment</h2>
                            <p>Prototype ideas without affecting the piano app.</p>
                            <a href="#">Add project</a>
                        </article>
                    </section>
                </main>

                <footer>
                    Hosted via GitHub Pages â€¢ c:\Git\coolportals
                </footer>
            </body>
            </html>
                r2bFrame.contentWindow.postMessage(event.data, '*');
                console.log('[Frame Router] R3â†’R2B: chord sent for analysis');
            }
        }
        else if (event.data.type === 'R3_FOCUS_AND_PLAY') {
            // Route R1â†’R3 (B25: Focus row and play)
            const r3Frame = document.getElementById('r3-frame');
            if (r3Frame && r3Frame.contentWindow) {
                r3Frame.contentWindow.postMessage(event.data, '*');
                console.log('[Frame Router] R1â†’R3: focus and play', event.data.rowIndex);
            }
        }
    });

    // ===== TIMESTAMP =====
    function updateFrameTimestamp() {
        const d = new Date();
        const yy = String(d.getFullYear()).slice(-2);
        const mm = String(d.getMonth()+1).padStart(2,'0');
        const dd = String(d.getDate()).padStart(2,'0');
        const hh = String(d.getHours()).padStart(2,'0');
        const mi = String(d.getMinutes()).padStart(2,'0');
        document.getElementById('frame-timestamp').textContent = `${yy}.${mm}.${dd} â€¢ ${hh}.${mi}`;
    }
    
    updateFrameTimestamp();
    setInterval(updateFrameTimestamp, 60000);

    // Note: iframes have same-origin policy, so cross-iframe communication 
    // via window.R1, window.R2A, window.R3, window.R2B requires all files 
    // to be served from same origin (http://localhost or file://)

    console.log('Frame loaded. All 4 panels should be visible.');
    console.log('Cross-origin restrictions apply if serving via file:// protocol.');
    console.log('Use local HTTP server for full cross-panel testing.');
</script>

</body>
</html>
