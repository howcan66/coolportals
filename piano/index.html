<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Piano Chords & Lyrics - Device Router</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #1a1a1a;
            color: #fff;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            overflow: hidden;
        }

        .loading-container {
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 4px solid #0d47a1;
            border-top: 4px solid #4fc3f7;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            font-size: 18px;
            color: #4fc3f7;
            font-weight: bold;
        }

        .device-info {
            font-size: 14px;
            color: #888;
            margin-top: 20px;
            text-align: center;
        }

        .device-info div {
            margin: 4px 0;
        }

        .error-container {
            background-color: #2a2a2a;
            border: 2px solid #f4a6a6;
            padding: 30px;
            border-radius: 8px;
            text-align: center;
            max-width: 500px;
        }

        .error-container h2 {
            color: #f4a6a6;
            margin-bottom: 15px;
        }

        .error-container p {
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .manual-links {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 20px;
        }

        .manual-link {
            display: inline-block;
            padding: 12px 24px;
            background-color: #0d47a1;
            color: #4fc3f7;
            text-decoration: none;
            border-radius: 4px;
            font-weight: bold;
            transition: all 0.3s;
            border: 1px solid #4fc3f7;
        }

        .manual-link:hover {
            background-color: #4fc3f7;
            color: #0d47a1;
        }

        .version-info {
            font-size: 12px;
            color: #666;
            margin-top: 30px;
        }

        .frame-header .workflow-steps {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            font-size: 0.68rem; /* compact */
            color: #e3f2fd;
            line-height: 1; /* tight row */
        }

        .frame-container {
            display: grid;
            grid-template-columns: 0.125fr 0.30fr 0.575fr;
            grid-template-rows: var(--row1-height, 0.3fr) 8px var(--row2-height, 0.7fr);
            grid-template-areas:
                "r1 r2a r2b"
                "r1 divider divider"
                "r1 r3 r3";
            gap: 6px;
            flex: 1;
            min-height: 0;
            position: relative;
        }

        .resize-divider {
            grid-area: divider;
            background: transparent;
            cursor: ns-resize;
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            user-select: none;
        }

        .resize-divider::before {
            content: '';
            width: 100%;
            height: 4px;
            background: #0d47a1;
            border-radius: 2px;
            transition: background 0.2s, height 0.2s;
        }

        .resize-divider:hover::before {
            background: #4dd0e1;
            height: 6px;
        }

        .resize-divider.dragging::before {
            background: #4dd0e1;
            height: 6px;
        }

        .frame-r1 { grid-area: r1; }
        .frame-r2a { grid-area: r2a; }
        .frame-r2b { grid-area: r2b; }
        .frame-r3 { grid-area: r3; }
        
        .frame-r3 iframe {
            overflow-y: auto;
        }

        .frame-wrapper {
            display: flex;
            flex-direction: column;
            background-color: #2a2a2a;
            border-radius: 2px;
            box-shadow: 0 1px 4px rgba(0,0,0,0.4);
            overflow: hidden;
        }

        .frame-r1 {
            overflow: auto;
        }

        .frame-r1 iframe {
            min-width: 260px;
        }

        iframe {
            flex: 1;
            border: none;
            background-color: #fff;
            min-height: 0;
        }
    </style>
</head>
<body>

<div class="loading-container" id="loading">
    <div class="loading-spinner"></div>
    <div class="loading-text">üéπ Loading Piano...</div>
    <div class="device-info">
        <div>Detecting device size...</div>
        <div id="device-width">Width: <span id="width-value">-</span>px</div>
        <div id="device-type">Type: <span id="type-value">-</span></div>
    </div>
</div>

<div class="error-container" id="error" style="display: none;">
    <h2>‚ö†Ô∏è Device Detection Failed</h2>
    <p>We couldn't automatically detect your device type. Please select your version manually:</p>
    <div class="manual-links">
        <a href="frame.html" class="manual-link">üñ•Ô∏è Desktop (4-panel)</a>
        <a href="frame-tablet.html" class="manual-link">üì± Tablet (2-panel)</a>
        <a href="frame-mobile.html" class="manual-link">üì≤ Mobile (1-panel)</a>
    </div>
    <div class="version-info">v2.1.0-dev Router</div>
</div>

<script>
    const APP_VERSION = 'v2.1.0-dev-router';
    
    function detectDevice() {
        const width = window.innerWidth;
        const height = window.innerHeight;
        
        // Update display
        document.getElementById('width-value').textContent = width;
        document.getElementById('device-width').innerHTML = `Width: <span id="width-value">${width}</span>px`;
        
        console.log(`[Device Router] Width: ${width}px, Height: ${height}px`);
        
        // Determine device type and redirect
        let deviceType, redirectUrl;
        
        if (width > 1024) {
            deviceType = 'Desktop (4-panel)';
            redirectUrl = 'frame.html';
            console.log('[Device Router] ‚Üí Desktop (frame.html)');
        } else if (width > 768) {
            deviceType = 'Tablet (2-panel)';
            redirectUrl = 'frame-tablet.html';
            console.log('[Device Router] ‚Üí Tablet (frame-tablet.html)');
        } else {
            deviceType = 'Mobile (1-panel)';
            redirectUrl = 'frame-mobile.html';
            console.log('[Device Router] ‚Üí Mobile (frame-mobile.html)');
        }
        
        document.getElementById('type-value').textContent = deviceType;
        
        // Redirect after 300ms (show loading screen briefly)
        setTimeout(() => {
            console.log('[Device Router] Redirecting to: ' + redirectUrl);
            window.location.href = redirectUrl;
        }, 300);
    }

    function showError() {
        document.getElementById('loading').style.display = 'none';
        document.getElementById('error').style.display = 'block';
        console.error('[Device Router] Device detection timeout - showing manual selection');
    }

    // Detect device immediately
    try {
        detectDevice();
    } catch (err) {
        console.error('[Device Router] Detection error:', err);
        showError();
    }

    // Fallback timeout (in case redirect takes too long)
    setTimeout(() => {
        console.warn('[Device Router] Redirect timeout - showing error screen');
        if (document.getElementById('loading').style.display !== 'none') {
            showError();
        }
    }, 5000);

    // Handle window resize (shouldn't happen during redirect, but good practice)
    window.addEventListener('resize', () => {
        const width = window.innerWidth;
        console.log('[Device Router] Window resized to:', width + 'px');
    });

    console.log('[Device Router] ' + APP_VERSION + ' loaded');
</script>

</body>
</html>
